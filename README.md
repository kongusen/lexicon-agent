# Lexicon Agent v2.0

> 下一代上下文工程驱动的智能助理框架

## 🎯 核心特性

- **上下文工程驱动**: 三层上下文处理架构 (检索生成、处理优化、管理压缩)
- **LLM自主编排**: 六阶段异步生成器实现智能决策循环
- **多Agent协作**: 五种编排策略支持复杂任务分解
- **流式优先设计**: 实时响应和状态更新
- **智能工具调度**: 基于依赖图的并行/串行优化执行

## 🏗️ 架构概览

```
┌─── 用户交互层 ───────────────────────────────────┐
│  Web界面 │ CLI界面 │ API接口 │ 流式事件处理      │
├─── 上下文工程层 ─────────────────────────────────┤
│  检索生成 │ 处理优化 │ 管理压缩 │ 上下文压缩器    │
├─── Agent控制层 ─────────────────────────────────┤
│  控制器 │ 编排引擎 │ 会话管理 │ 提示组装 │ 流生成│
├─── 工具编排层 ───────────────────────────────────┤
│  执行器 │ 注册表 │ 调度器 │ MCP网关 │ 依赖解析│
├─── 工具实现层 ───────────────────────────────────┤
│  核心工具 │ 外部工具 │ 知识库 │ 代码沙箱 │ 协调器│
└─── 基础设施层 ───────────────────────────────────┘
│  LLM提供商 │ 向量存储 │ 文件系统 │ 内存管理器│
```

## 🚀 快速开始

### 安装依赖

```bash
# 使用 Poetry (推荐)
poetry install

# 或使用 pip
pip install -r requirements.txt
```

### 基础使用

```python
import asyncio
from lexicon_agent import LexiconAgent, ContextRequirements

async def main():
    # 初始化Agent
    agent = LexiconAgent(
        llm_provider="anthropic",
        model="claude-3-sonnet-20240229"
    )
    
    # 流式对话
    async for event in agent.stream_run("帮我分析这个项目的架构"):
        print(f"{event.type}: {event.content}")

if __name__ == "__main__":
    asyncio.run(main())
```

## 📁 项目结构

```
lexicon_agent/
├── core/                   # 核心组件
│   ├── context/           # 上下文工程
│   ├── orchestration/     # 编排引擎
│   ├── agent/            # Agent控制器
│   └── streaming/        # 流式处理
├── tools/                 # 工具系统
│   ├── registry/         # 工具注册
│   ├── executor/         # 执行引擎
│   └── scheduler/        # 智能调度
├── infrastructure/        # 基础设施
│   ├── llm/              # LLM提供商
│   ├── storage/          # 存储系统
│   └── memory/           # 内存管理
└── api/                  # API接口
    ├── rest/             # REST API
    ├── websocket/        # WebSocket
    └── cli/              # 命令行界面
```

## 🔧 核心概念

### 上下文工程

Lexicon Agent的核心是上下文工程，通过三个基本组件处理信息：

1. **上下文检索与生成**: 多策略并行检索、动态上下文组装
2. **上下文处理**: 长序列处理、自我优化、结构化集成
3. **上下文管理**: 约束解决、内存层次、智能压缩

### 六阶段生成循环

受Claude Code启发的主控制循环：

1. **上下文检索与生成**: 分析需求并获取相关上下文
2. **上下文处理与优化**: 处理和优化上下文信息
3. **LLM流式响应**: 生成智能响应和工具调用
4. **工具编排执行**: 智能调度和执行工具
5. **结果聚合更新**: 整合结果并更新上下文
6. **递归循环控制**: 决定是否继续处理

### 多Agent编排

支持五种编排策略：
- **先验编排**: 预分析任务后分配Agent
- **后验编排**: 多Agent并行处理后选择最优结果
- **功能型编排**: 基于Agent专业能力分工
- **组件型编排**: 动态组装工作流
- **木偶师编排**: 中央协调多Agent协作

## 📊 性能特性

- **首Token延迟**: < 200ms
- **并发请求处理**: > 50 req/s
- **内存占用**: < 1GB (单会话)
- **工具执行成功率**: > 95%
- **系统错误率**: < 1%

## 🛠️ 开发指南

详见 [开发文档](docs/Lexicon%20Agent:%20系统设计与开发指南%20v2.0.md)

## 📝 许可证

MIT License